[gd_scene load_steps=19 format=3 uid="uid://cgfnwtxbl14yp"]

[ext_resource type="Script" path="res://Scripts/DrawingGrader.gd" id="1_c2la4"]
[ext_resource type="Script" path="res://Scripts/Level.gd" id="1_fwlpn"]
[ext_resource type="PackedScene" uid="uid://cbkrudifu2xkr" path="res://Scenes/GuideLine.tscn" id="2_hhy5b"]
[ext_resource type="Script" path="res://Scripts/BulletHell/ProjectileGenerator.gd" id="3_ep5s1"]
[ext_resource type="PackedScene" uid="uid://ckt2ug7d6uwrw" path="res://Scenes/WaterProjectile.tscn" id="5_44i16"]
[ext_resource type="Script" path="res://Scripts/BulletHell/ProjectileGeneratorStep.gd" id="5_tsiwy"]
[ext_resource type="Script" path="res://Scripts/BulletHell/SpawnPointGenerator.gd" id="6_qo587"]
[ext_resource type="Script" path="res://Scripts/Player.gd" id="7_1325q"]
[ext_resource type="PackedScene" uid="uid://cmn84sc4c3hn3" path="res://Scenes/LineDrawer.tscn" id="8_7gopk"]
[ext_resource type="Texture2D" uid="uid://dylu3cq3lws6h" path="res://Sprites/PlayerHurtbox.png" id="9_xrk6d"]
[ext_resource type="Texture2D" uid="uid://crhpivl7bdwgs" path="res://Sprites/Pen.png" id="10_p2h1b"]
[ext_resource type="Script" path="res://Scripts/MouseInputHandler.gd" id="11_aqkge"]
[ext_resource type="Texture2D" uid="uid://d18tb4gbtrcct" path="res://Sprites/Background.png" id="12_ffcdh"]

[sub_resource type="CanvasTexture" id="CanvasTexture_a0bh2"]

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_0wrkl"]

[sub_resource type="Resource" id="Resource_2w8dj"]
script = ExtResource("5_tsiwy")
skip = false
spawn_position_parent_path = NodePath("SpawnPointGenerator")
projectile_scene = ExtResource("5_44i16")
aim_rotation_source_path = NodePath("")
aim_type = 0
position_offset = Vector2(0, 0)
rotation_offset_degrees = 0.0
spawn_delay = 0.0
transition_delay = 1.0
spawn_cycles = 1
step_cycles = 1
sound_effect_name = ""
sound_type = 0

[sub_resource type="Resource" id="Resource_6wutw"]
script = ExtResource("5_tsiwy")
skip = false
spawn_position_parent_path = NodePath("SpawnPointGenerator2")
projectile_scene = ExtResource("5_44i16")
aim_rotation_source_path = NodePath("")
aim_type = 0
position_offset = Vector2(0, 0)
rotation_offset_degrees = 0.0
spawn_delay = 0.0
transition_delay = 1.0
spawn_cycles = 1
step_cycles = 1
sound_effect_name = ""
sound_type = 0

[sub_resource type="CircleShape2D" id="CircleShape2D_d5p4o"]
radius = 3.0

[node name="Level" type="Node2D"]
script = ExtResource("1_fwlpn")
metadata/_edit_vertical_guides_ = [1.0]

[node name="ResultsUI" type="CanvasLayer" parent="."]
layer = 2
visible = false

[node name="Background" type="TextureRect" parent="ResultsUI"]
modulate = Color(0, 0, 0, 0.490196)
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 0
texture = SubResource("CanvasTexture_a0bh2")

[node name="ResultsPanel" type="Panel" parent="ResultsUI"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -71.0
offset_top = -71.0
offset_right = 71.0
offset_bottom = 71.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="ResultsUI/ResultsPanel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 4.0
offset_top = 3.0
offset_right = -4.0
offset_bottom = -3.0
grow_horizontal = 2
grow_vertical = 2

[node name="Spacer" type="Control" parent="ResultsUI/ResultsPanel/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
size_flags_stretch_ratio = 0.05

[node name="ResultsHeader" type="Label" parent="ResultsUI/ResultsPanel/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 6
text = "Results:"
horizontal_alignment = 1

[node name="Results" type="Label" parent="ResultsUI/ResultsPanel/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 6
size_flags_stretch_ratio = 2.92
text = "The Results go here but they don't exist yet"
horizontal_alignment = 1
autowrap_mode = 3

[node name="RestartLevelButton" type="Button" parent="ResultsUI/ResultsPanel/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
size_flags_stretch_ratio = 0.71
text = "Retry"

[node name="NextButton" type="Button" parent="ResultsUI/ResultsPanel/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
size_flags_stretch_ratio = 0.71
text = "Next"

[node name="GameUI" type="CanvasLayer" parent="."]

[node name="DoneButton" type="Button" parent="GameUI"]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -52.0
offset_top = -23.0
offset_right = -2.0
offset_bottom = -2.0
grow_horizontal = 0
grow_vertical = 0
text = "Done!"

[node name="RestartButton" type="Button" parent="GameUI"]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -53.0
offset_top = 2.0
offset_right = -2.0
offset_bottom = 23.0
grow_horizontal = 0
text = "Restart"

[node name="Walls" type="StaticBody2D" parent="." groups=["Wall"]]
metadata/_edit_lock_ = true

[node name="Left" type="CollisionShape2D" parent="Walls"]
position = Vector2(56, 144)
rotation = 1.5708
shape = SubResource("WorldBoundaryShape2D_0wrkl")
metadata/_edit_lock_ = true

[node name="Bottom" type="CollisionShape2D" parent="Walls"]
position = Vector2(144, 257)
shape = SubResource("WorldBoundaryShape2D_0wrkl")
metadata/_edit_lock_ = true

[node name="Right" type="CollisionShape2D" parent="Walls"]
position = Vector2(233, 144)
rotation = -1.5708
shape = SubResource("WorldBoundaryShape2D_0wrkl")
metadata/_edit_lock_ = true

[node name="Top" type="CollisionShape2D" parent="Walls"]
position = Vector2(144, 28)
rotation = 3.14159
shape = SubResource("WorldBoundaryShape2D_0wrkl")
metadata/_edit_lock_ = true

[node name="DrawingGrader" type="Node" parent="." node_paths=PackedStringArray("source_line_parent", "drawing_line_parent")]
script = ExtResource("1_c2la4")
source_line_parent = NodePath("../Drawings/FlowerDrawingGuide")
drawing_line_parent = NodePath("../Drawings/PlayerLineParent")

[node name="Drawings" type="Node" parent="."]

[node name="TestDrawingGuide" type="Node" parent="Drawings"]

[node name="GuideLine" type="Line2D" parent="Drawings/TestDrawingGuide"]
visible = false
top_level = true
points = PackedVector2Array(190, 59, 205, 102, 201, 146)
width = 2.0
default_color = Color(0.447059, 0.447059, 0.447059, 1)

[node name="FlowerDrawingGuide" type="Node" parent="Drawings"]

[node name="GuideLine" parent="Drawings/FlowerDrawingGuide" instance=ExtResource("2_hhy5b")]
points = PackedVector2Array(118, 105, 123, 93, 136, 86, 151, 89, 159, 102, 155, 119, 139, 129, 122, 121, 118, 105)
metadata/_edit_lock_ = true

[node name="GuideLine2" parent="Drawings/FlowerDrawingGuide" instance=ExtResource("2_hhy5b")]
points = PackedVector2Array(123, 93, 112, 83, 108, 68, 112, 58, 124, 61, 133, 72, 136, 86, 145, 72, 154, 63, 165, 62, 167, 72, 163, 85, 153, 94, 170, 89, 183, 86, 188, 93, 191, 102, 188, 109, 178, 113, 166, 114, 157, 112, 165, 125, 171, 138, 167, 147, 158, 150, 148, 146, 145, 139, 140, 129, 134, 140, 128, 146, 120, 151, 109, 153, 106, 140, 112, 129, 121, 121, 107, 119, 96, 117, 90, 112, 88, 104, 92, 97, 101, 93, 112, 93, 123, 93)
metadata/_edit_lock_ = true

[node name="GuideLine3" parent="Drawings/FlowerDrawingGuide" instance=ExtResource("2_hhy5b")]
points = PackedVector2Array(144, 137, 150, 148, 155, 162, 163, 156, 172, 152, 181, 151, 186, 155, 186, 162, 182, 169, 174, 172, 167, 171, 156, 169, 157, 178, 156, 189, 153, 205, 147, 222, 139, 234, 127, 234, 136, 221, 140, 211, 143, 197, 132, 196, 122, 194, 117, 189, 115, 182, 119, 177, 125, 176, 132, 177, 139, 181, 144, 190, 146, 175, 144, 163, 140, 150, 134, 139)
metadata/_edit_lock_ = true

[node name="GuideLine4" parent="Drawings/FlowerDrawingGuide" instance=ExtResource("2_hhy5b")]
points = PackedVector2Array(133, 224, 121, 224, 111, 227, 104, 231, 100, 238, 107, 244, 121, 248, 140, 249, 155, 249, 167, 247, 177, 245, 182, 234, 177, 229, 166, 226, 156, 225, 146, 225)
metadata/_edit_lock_ = true

[node name="PlayerLineParent" type="Node" parent="Drawings"]

[node name="ProjectileGenerator" type="Node2D" parent="." node_paths=PackedStringArray("projectile_parent")]
script = ExtResource("3_ep5s1")
projectile_parent = NodePath("ProjectileParent")
steps = Array[ExtResource("5_tsiwy")]([SubResource("Resource_2w8dj"), SubResource("Resource_6wutw")])

[node name="ProjectileParent" type="Node" parent="ProjectileGenerator"]

[node name="SpawnPointGenerator" type="Node2D" parent="ProjectileGenerator"]
position = Vector2(68, -18)
script = ExtResource("6_qo587")
enabled = true
point_count = 4
init_rotation = 90.0
position_offset = Vector2(42, 0)

[node name="0" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator"]
rotation = 1.5708

[node name="1" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator"]
position = Vector2(42, 0)
rotation = 1.5708

[node name="2" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator"]
position = Vector2(84, 0)
rotation = 1.5708

[node name="3" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator"]
position = Vector2(126, 0)
rotation = 1.5708

[node name="SpawnPointGenerator2" type="Node2D" parent="ProjectileGenerator"]
position = Vector2(68, -18)
script = ExtResource("6_qo587")
enabled = true
point_count = 4
init_position = Vector2(23, 0)
init_rotation = 90.0
position_offset = Vector2(42, 0)

[node name="0" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator2"]
position = Vector2(23, 0)
rotation = 1.5708

[node name="1" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator2"]
position = Vector2(65, 0)
rotation = 1.5708

[node name="2" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator2"]
position = Vector2(107, 0)
rotation = 1.5708

[node name="3" type="Marker2D" parent="ProjectileGenerator/SpawnPointGenerator2"]
position = Vector2(149, 0)
rotation = 1.5708

[node name="Player" type="CharacterBody2D" parent="." node_paths=PackedStringArray("line_parent")]
z_index = 3
position = Vector2(210, 246)
motion_mode = 1
script = ExtResource("7_1325q")
line_drawer_scene = ExtResource("8_7gopk")
line_parent = NodePath("../Drawings/PlayerLineParent")
max_grab_distance = 8.0

[node name="HurtboxSprite" type="Sprite2D" parent="Player"]
texture = ExtResource("9_xrk6d")

[node name="PenSprite" type="Sprite2D" parent="Player"]
modulate = Color(1, 1, 1, 0.466667)
position = Vector2(1, -6)
texture = ExtResource("10_p2h1b")
centered = false
offset = Vector2(0, -128)

[node name="Hurtbox" type="CollisionShape2D" parent="Player"]
shape = SubResource("CircleShape2D_d5p4o")

[node name="MouseInputHandler" type="Node2D" parent="Player"]
script = ExtResource("11_aqkge")

[node name="Background" type="Sprite2D" parent="."]
z_index = -4
position = Vector2(144, 144)
texture = ExtResource("12_ffcdh")
metadata/_edit_lock_ = true

[connection signal="game_ended" from="." to="ProjectileGenerator" method="_on_game_ended"]
[connection signal="game_ended" from="." to="Player" method="_on_game_ended"]
[connection signal="game_started" from="." to="ProjectileGenerator" method="_on_game_started"]
[connection signal="pressed" from="ResultsUI/ResultsPanel/VBoxContainer/RestartLevelButton" to="." method="_on_restart_button_pressed"]
[connection signal="pressed" from="ResultsUI/ResultsPanel/VBoxContainer/NextButton" to="." method="_on_next_button_pressed"]
[connection signal="pressed" from="GameUI/DoneButton" to="." method="_on_done_button_pressed"]
[connection signal="pressed" from="GameUI/RestartButton" to="." method="_on_restart_button_pressed"]
[connection signal="pen_grabbed" from="Player" to="." method="_on_pen_grabbed"]
[connection signal="left_mouse_pressed" from="Player/MouseInputHandler" to="Player" method="_on_left_mouse_pressed"]
[connection signal="left_mouse_released" from="Player/MouseInputHandler" to="Player" method="_on_left_mouse_released"]
